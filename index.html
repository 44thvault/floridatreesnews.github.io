<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLORIDA TREES NEWS 2026®</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-green: #000000;
            --secondary-green: #000000;
            --accent-gold: #000000;
            --bg-cream: #ffffff;
            --text-dark: #000000;
            --link-hover: #333333;
            --border-color: #000000;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier Prime', 'Courier New', monospace;
            background: var(--bg-cream);
            color: var(--text-dark);
            line-height: 1.5;
            padding: 0;
        }

        .top-banner {
            background: #ffffff;
            padding: 25px 20px;
            text-align: center;
            border-bottom: 4px solid #000000;
            box-shadow: none;
            position: relative;
            overflow: hidden;
        }

        .top-banner::before {
            display: none;
        }

        @keyframes slidePattern {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        .logo {
            font-family: 'Courier Prime', 'Courier New', monospace;
            font-size: 52px;
            color: #000000;
            text-shadow: none;
            letter-spacing: 4px;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
            font-weight: 700;
            animation: fadeInDown 0.8s ease-out;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tagline {
            font-family: 'Courier Prime', 'Courier New', monospace;
            font-size: 15px;
            color: #000000;
            font-style: italic;
            letter-spacing: 1px;
            position: relative;
            z-index: 1;
            opacity: 1;
        }

        .cannabis-leaf {
            display: inline-block;
            color: var(--accent-gold);
            margin: 0 8px;
            font-size: 20px;
        }

        .last-update {
            text-align: center;
            padding: 12px;
            background: #f5f5f5;
            font-size: 13px;
            color: #000000;
            border-bottom: 1px solid #000000;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .news-item {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #cccccc;
            transition: padding-left 0.2s ease;
        }

        .news-item:last-child {
            border-bottom: none;
        }

        .news-item:hover {
            padding-left: 8px;
        }

        .news-item a {
            color: var(--text-dark);
            text-decoration: none;
            font-weight: 700;
            font-size: 16px;
            line-height: 1.5;
            transition: color 0.2s ease;
            display: block;
        }

        .news-item a:hover {
            color: #333333;
        }

        .news-item .meta {
            font-size: 12px;
            color: #666666;
            margin-top: 5px;
            font-style: italic;
        }

        #news-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .footer {
            text-align: center;
            padding: 30px 20px;
            background: #000000;
            color: #ffffff;
            margin-top: 40px;
            font-size: 14px;
        }

        .footer a {
            color: #ffffff;
            text-decoration: none;
            font-weight: 600;
        }

        .footer a:hover {
            color: #cccccc;
        }

        .stats {
            margin-top: 15px;
            font-size: 12px;
            opacity: 0.9;
            font-family: 'Courier Prime', 'Courier New', monospace;
            letter-spacing: 1px;
        }

        @media (max-width: 768px) {
            .logo {
                font-size: 36px;
            }
        }
    </style>
</head>
<body>
    <div class="top-banner">
        <div class="logo">
            FLORIDA TREES NEWS
        </div>
        <div class="tagline">Your source for cannabis news and information in the Sunshine State</div>
    </div>

    <div class="last-update" id="lastUpdate">
        Last Updated: <span id="updateTime"></span>
    </div>

    <div class="container">
        <div id="news-container">
            <!-- News items will be loaded here -->
            <div class="news-item">
                <a href="#">Loading news...</a>
                <div class="meta">Please wait</div>
            </div>
        </div>
    </div>

    <div class="footer">
        <p style="margin-top: 15px; font-size: 11px; opacity: 0.8;">
            This site aggregates news from various sources. All trademarks and copyrights belong to their respective owners.
        </p>
    </div>

    <script>
        // Update timestamp
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric', 
                hour: '2-digit', 
                minute: '2-digit',
                timeZoneName: 'short'
            });
            document.getElementById('updateTime').textContent = timeString;
        }
        updateTime();
        setInterval(updateTime, 60000); // Update every minute

        // NewsAPI.org Integration
        const NEWSAPI_KEY = 'b97f01d7f0e24181bf1c31294c7ad6d3';
        const NEWSAPI_ENDPOINT = 'https://newsapi.org/v2/everything';

        async function fetchCannabisNews() {
            try {
                // More specific Florida cannabis query
                const query = 'Florida AND (cannabis OR marijuana OR hemp OR pot)';
                
                const url = `${NEWSAPI_ENDPOINT}?q=${encodeURIComponent(query)}&language=en&sortBy=publishedAt&pageSize=100&apiKey=${NEWSAPI_KEY}`;
                
                console.log('Fetching news...');
                
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    console.error('API Error:', response.status, response.statusText);
                    const errorData = await response.text();
                    console.error('Error details:', errorData);
                    
                    // Display error message to user
                    displayError(`API Error: ${response.status}. Check console for details.`);
                    return;
                }

                const data = await response.json();
                console.log('API Response:', data);
                
                if (data.status === 'error') {
                    console.error('API Error:', data.message);
                    displayError(`API Error: ${data.message}`);
                    return;
                }

                if (data.articles && data.articles.length > 0) {
                    // Filter articles to only show ones with specific Florida keywords
                    const filteredArticles = filterFloridaArticles(data.articles);
                    
                    if (filteredArticles.length > 0) {
                        displayNews(filteredArticles);
                    } else {
                        displayError('No Florida cannabis news found. Try again later.');
                    }
                } else {
                    console.log('No articles found');
                    displayError('No articles found. Try again later.');
                }
            } catch (error) {
                console.error('Error fetching news:', error);
                displayError(`Failed to fetch news: ${error.message}. Check your internet connection.`);
            }
        }

        function filterFloridaArticles(articles) {
            // Keywords that must appear in title or description
            const requiredKeywords = [
                'florida cannabis',
                'florida marijuana', 
                'florida hemp',
                'florida pot'
            ];
            
            return articles.filter(article => {
                const title = (article.title || '').toLowerCase();
                const description = (article.description || '').toLowerCase();
                const content = (article.content || '').toLowerCase();
                const fullText = `${title} ${description} ${content}`;
                
                // Check if ANY of the required keyword phrases appear
                return requiredKeywords.some(keyword => fullText.includes(keyword));
            });
        }

        function displayError(message) {
            const container = document.getElementById('news-container');
            if (!container) return;
            
            container.innerHTML = `
                <div class="news-item">
                    <a href="#" style="color: #cc0000; cursor: default;" onclick="return false;">${message}</a>
                    <div class="meta">Please refresh the page or try again later</div>
                </div>
            `;
        }

        function displayNews(articles) {
            const container = document.getElementById('news-container');
            
            if (!container) {
                console.error('News container not found');
                return;
            }

            const newsHTML = articles.map(article => {
                const publishedDate = new Date(article.publishedAt);
                const timeAgo = getTimeAgo(publishedDate);
                const source = article.source?.name || 'Unknown Source';

                return `
                    <div class="news-item">
                        <a href="${article.url}" target="_blank">${article.title}</a>
                        <div class="meta">${source} • ${timeAgo}</div>
                    </div>
                `;
            }).join('');

            container.innerHTML = newsHTML;
            console.log(`Loaded ${articles.length} news articles`);
        }

        function getTimeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            
            const intervals = {
                year: 31536000,
                month: 2592000,
                week: 604800,
                day: 86400,
                hour: 3600,
                minute: 60
            };

            for (const [unit, secondsInUnit] of Object.entries(intervals)) {
                const interval = Math.floor(seconds / secondsInUnit);
                if (interval >= 1) {
                    return `${interval} ${unit}${interval !== 1 ? 's' : ''} ago`;
                }
  